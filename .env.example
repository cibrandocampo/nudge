# ─────────────────────────────────────────────────────────
#  Nudge — Environment variables
#  Copy this file to .env and fill in the real values.
#  NEVER commit .env to the repository.
# ─────────────────────────────────────────────────────────

# ── Project ───────────────────────────────────────────────
PROJECT_NAME=nudge

# ── Docker images ─────────────────────────────────────────
DOCKER_NUDGE_VERSION=stable
DOCKER_POSTGRES_VERSION=16-alpine
DOCKER_REDIS_VERSION=7-alpine

# Port exposed on the host for the frontend (HTTP).
# If you run a reverse proxy (nginx, Traefik, Synology, etc.) set this to
# any free port (e.g. 8080) and point the proxy to it.
NUDGE_HTTP_PORT=80

# Internal backend port (gunicorn). Must stay 8000 unless you also update nginx.conf.
BACKEND_PORT=8000

# Gunicorn worker processes (rule of thumb: 2 × CPU cores + 1)
GUNICORN_WORKERS=2

# Log level for the Django backend (debug | info | warning | error | critical)
DJANGO_LOG_LEVEL=info

# Log level for the Celery worker (debug | info | warning | error | critical)
CELERY_LOG_LEVEL=info

# Host path for PostgreSQL data persistence
DATA_PATH=./data

# ── Default admin user ────────────────────────────────────
# Created automatically on first startup if no superuser exists.
# After first boot, this password can only be changed from the Django admin panel.
ADMIN_USERNAME=admin
ADMIN_EMAIL=admin@example.com
ADMIN_PASSWORD=change-me

# ── Django ────────────────────────────────────────────────
# Generate a strong secret key with:
#   python -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"
# Or use any password manager to generate a long random string.
DJANGO_SECRET_KEY=change-me

# Must be False in production.
DJANGO_DEBUG=False

# Comma-separated list of hostnames Django will accept requests for.
# Always include:
#   - your public domain (e.g. nudge.example.com)
#   - localhost — required for the Docker healthcheck (it hits the backend
#     directly on localhost:8000 and Django would reject it otherwise)
# If accessing by IP during setup, add that IP too (e.g. 192.168.1.10).
# Example: DJANGO_ALLOWED_HOSTS=nudge.example.com,localhost
DJANGO_ALLOWED_HOSTS=yourdomain.com,localhost

# Comma-separated list of allowed CORS origins. Must match exactly the origin
# the browser uses to reach the app (scheme + host + port).
# No trailing slash, no wildcards.
CORS_ALLOWED_ORIGINS=https://yourdomain.com

# Comma-separated list of trusted origins for Django's CSRF protection.
# Must include every domain that posts forms to the backend (including the admin).
# Same format as CORS_ALLOWED_ORIGINS.
CSRF_TRUSTED_ORIGINS=https://yourdomain.com

# ── Database (PostgreSQL) ─────────────────────────────────
POSTGRES_DB=nudge
POSTGRES_USER=nudge
# Choose a strong random password. Use the same value in DATABASE_URL below.
POSTGRES_PASSWORD=change-me

# Full connection URL — keep in sync with POSTGRES_PASSWORD above.
DATABASE_URL=postgresql://nudge:change-me@db:5432/nudge

# ── Redis / Celery ────────────────────────────────────────
REDIS_URL=redis://redis:6379/0

# ── Web Push — VAPID keys ─────────────────────────────────
# VAPID keys authenticate push messages sent to browsers.
# Generate the key pair once and keep them safe — regenerating invalidates
# all existing push subscriptions and users will need to re-enable notifications.
#
# How to generate:
#   pip install py-vapid
#   vapid --gen                   # creates private_key.pem and public_key.pem
#   vapid --applicationServerKey  # prints the two values you need
#
# From the output:
#   "Application Server Key" → VAPID_PUBLIC_KEY  (and VITE_VAPID_PUBLIC_KEY)
#   "Private key"            → VAPID_PRIVATE_KEY
#
# You can also run this inside any Docker container that has Python:
#   docker exec -it <container> sh
#   pip install py-vapid && vapid --gen && vapid --applicationServerKey
#
# The .pem files are only needed to re-print the keys later — you do not need
# to keep them on the server.
VAPID_PRIVATE_KEY=
VAPID_PUBLIC_KEY=

# Contact email included in VAPID claims (used by browser vendors to reach you
# if there are delivery issues — not shown to end users).
VAPID_CLAIMS_EMAIL=admin@example.com

# ── Frontend (Vite) ───────────────────────────────────────
# The URL the browser uses to reach the API. No trailing slash.
# For a reverse-proxy setup this is typically https://yourdomain.com/api.
# The nginx inside the frontend container proxies /api/ to the backend, so
# the backend port is never exposed directly to the internet.
VITE_API_BASE_URL=https://yourdomain.com/api

# Same value as VAPID_PUBLIC_KEY — duplicated here because Vite needs it at
# build time to embed it in the service worker.
VITE_VAPID_PUBLIC_KEY=
